This is Chapter 5 in test-branch.
